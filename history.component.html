<div class="container my-5 history-page">

  <!-- Header -->
  <div class="d-flex justify-content-between align-items-center mb-4">
    <h2><i class="fa fa-history me-2 text-primary"></i>Payment History</h2>
    <button class="btn btn-success" (click)="downloadAllInvoices()">
      <i class="fa fa-download me-2"></i>Download All Invoices
    </button>
  </div>

  <!-- Filters -->
  <div class="row mb-3 g-3">
    <div class="col-md-4">
      <select class="form-select" [(ngModel)]="selectedMonth">
        <option value="">All Months</option>
        <option *ngFor="let month of months" [value]="month">{{ month }}</option>
      </select>
    </div>
    <div class="col-md-4">
      <select class="form-select" [(ngModel)]="selectedStatus">
        <option value="">All Status</option>
        <option *ngFor="let status of statuses" [value]="status">{{ status }}</option>
      </select>
    </div>
    <div class="col-md-4">
      <select class="form-select" [(ngModel)]="selectedMethod">
        <option value="">All Methods</option>
        <option *ngFor="let method of methods" [value]="method">{{ method }}</option>
      </select>
    </div>
  </div>

  <!-- Payment Table -->
  <div class="table-responsive">
    <table class="table table-striped align-middle">
      <thead class="table-light">
        <tr>
          <th>Date</th>
          <th>Amount</th>
          <th>Method</th>
          <th>Status</th>
          <th>Invoice</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let payment of filteredPayments()">
          <td>{{ payment.date | date:'shortDate' }}</td>
          <td>{{ payment.amount }}</td>
          <td>{{ payment.method }}</td>
          <td>
            <span [ngClass]="statusClass(payment.status)" class="fw-bold px-2 py-1 rounded">
              {{ payment.status }}
            </span>
          </td>
          <td>
            <button class="btn btn-sm btn-outline-primary" (click)="downloadInvoice(payment)">
              <i class="fa fa-download"></i>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

</div>
